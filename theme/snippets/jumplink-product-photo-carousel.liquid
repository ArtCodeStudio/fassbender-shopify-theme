{% comment %}
    Carousel
{% endcomment %}
<div class="row" data-colorcard="placeholder">
    <div class="hidden-sm-down col-sm-2">
        <div class="mb-1">
            <div class="product-photo-carousel-arrows d-flex justify-content-between">
                {% comment %}
                    @see https://github.com/kenwheeler/slick#methods
                {% endcomment %}
                <div data-slick-method="slickPrev" data-target="#product-photo-carousel-{{product.handle}}">
                    {% include 'jumplink-iconset', name: 'arrow-big', direction: 'left', color: 'black' %}
                </div>
                <div data-slick-method="slickNext" data-target="#product-photo-carousel-{{product.handle}}">
                    {% include 'jumplink-iconset', name: 'arrow-big', direction: 'right', color: 'black' %}
                </div>
            </div>
        </div>

        {% for image in product.images %}
            {% if forloop.last %}
                {% comment %} This is the Colorcard {% endcomment %}
            {% else %}
                <div data-index="{{ forloop.index0 }}" class="thumb mb-1">
                    <div class="background-box {{settings.products_aspect_ratio}}" style="background-image: url({{ image | img_url: 'grande' }});" title="{{ image.alt | escape }}"></div>
                </div>
            {% endif %}
        {% else %}
            <div class="mb-1">
               <div data-index="{{ forloop.index0 }}" class="thumb">
                  <div class="background-box {{settings.products_aspect_ratio}}" style="background-image: url({{ 'no-image.png' | asset_url }});" title="No Product Image"></div>
               </div>
            </div>
        {% endfor %}

        {% comment %} video {% endcomment %}
        {% if product.metafields.jumplink_video.preview_url and product.metafields.jumplink_video.mp4_url %}
            <div class="mb-1">
                <div data-index="{{ product.images | size }}" class="thumb">
                    <div class="background-box {{settings.products_aspect_ratio}}" style="background-image: url({{ product.metafields.jumplink_video.preview_url }});" title="{{ product.title }}"></div>
                </div>
            </div>
        {% endif %}
    </div>

    <div class="col-xs-12 col-sm-10">

        <div class="product-photo-carousel" id="product-photo-carousel-{{product.handle}}" data-toggle="modal-no-touch" data-backdrop="false" data-target="#product-photo-modal-{{product.handle}}">
            {% for image in product.images %}
                {% if forloop.last %}
                    {% comment %} This is the Colorcard {% endcomment %}
                {% else %}
                    <a class="product-photo-carousel-item">
                        <div class="background-box {{settings.products_aspect_ratio}}" style="background-image: url({{ image | img_url: 'master' }});" title="{{ image.alt | escape }}"></div>
                        {% if settings.products_show_page_number_in_carousel %}
                            <div class="carousel-caption bottom right">
                                <div class="carousel-caption-wrapper">
                                    {{ forloop.index }}/{{ forloop.length }}
                                </div>
                            </div>
                        {% endif %}
                    </a>
                {% endif %}
            {% else %}
                <a class="product-photo-carousel-item">
                    <div class="background-box {{settings.products_aspect_ratio}}" style="background-image: url({{ 'no-image.png' | asset_url }});" title="No Product Image"></div>
                </a>
            {% endfor %}

            {% comment %} video {% endcomment %}
            {% if product.metafields.jumplink_video.preview_url and product.metafields.jumplink_video.mp4_url %}
                <a class="product-photo-carousel-item">
                    <video class="video-js" id="video-{{product.handle}}" controls muted preload="auto" width="1317" height="2048"
                        poster="{{product.metafields.jumplink_video.preview_url}}" data-setup='{ "aspectRatio":"1317:2048" }'>
                        <source src="{{product.metafields.jumplink_video.mp4_url}}" type='video/mp4'>
                        {% if product.metafields.jumplink_video.ogv_url %}
                            <source src="{{product.metafields.jumplink_video.ogv_url}}" type='video/ogg'>
                        {% endif %}
                        {% if product.metafields.jumplink_video.webm_url %}
                            <source src="{{product.metafields.jumplink_video.webm_url}}" type='video/webm'>
                        {% endif %}
                    </video>
                    {% if settings.products_show_page_number_in_carousel %}
                        <div class="carousel-caption bottom right">
                            <div class="carousel-caption-wrapper">
                                {{ product.images | size }}/{{ product.images | size }}
                            </div>
                        </div>
                    {% endif %}
                </a>
            {% endif %}
        </div>
    </div>

</div>

{% comment %}
    Modal
{% endcomment %}
{% include 'jumplink-product-photo-modal' %}

<div class="preloaded-images">
    <img src="{{ product.images.last.src | img_url: "master" }}" width="1" height="1" alt="Last Product Image" />
</div>